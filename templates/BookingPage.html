<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <link rel="" href="doc.js">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@200;400&display=swap" rel="stylesheet">

    <style>
        body {
            background-image: url("{{ url_for('static', filename='images/GettyImages-185331541.webp') }}");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            height: 100vh;
            margin: 0;
            font-family: 'Josefin Sans', sans-serif;
            border-radius: 30px; /* Adjust the radius as needed */
        }

        .booking-form {
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 10px;
            color: white;
            padding: 20px;
            max-width: 600px;
            margin: 50px auto;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.6);
        }

        .booking-form h2 {
            text-align: center;
            margin-bottom: 20px;
            color: white; /* Change text color to white */
        }

        .booking-form .form-group {
            margin-bottom: 15px;
        }

        .booking-form .form-group label {
            display: block;
            margin-bottom: 5px;
            color: white; /* Change text color to white */
        }

        .booking-form .form-group select,
        .booking-form .form-group input {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 5px;
        }

        .booking-form .form-group button {
            width: 100%;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .booking-form .form-group button:hover {
            background-color: rgba(0, 0, 0, 0.9);
        }

        @media only screen and (max-width: 768px) {
            .booking-form {
                width: 90%;
                padding: 10px;
            }
        }

        @media only screen and (max-width: 768px){
            • {width : 100%;}
            •col-2 {width : 100%;}
            •col-3 {width : 100%;}
        }

        .alert {
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 5px;
        font-weight: bold;
    }
    .alert-success {
        background-color: #d4edda;
        color: #155724;
    }
    .alert-danger {
        background-color: #f8d7da;
        color: #721c24;
    }
    </style>

    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const routeSelect = document.getElementById('source_city');
            const dateSelect = document.getElementById('departure_date');

            routeSelect.addEventListener('change', function () {
                const selectedRoute = this.value;

                // Filter dates based on the selected route
                Array.from(dateSelect.options).forEach(option => {
                    if (option.dataset.route === selectedRoute) {
                        option.style.display = 'block';
                    } else {
                        option.style.display = 'none';
                    }
                });

                // Reset the date selection
                dateSelect.value = '';
            });

            // Trigger the change event on page load to filter dates for the default route
            routeSelect.dispatchEvent(new Event('change'));
        });

        document.addEventListener('DOMContentLoaded', function() {
    const dateInputs = [document.getElementById('departure_date')];
    dateInputs.forEach(input => {
        input.addEventListener('input', function() {
            const date = new Date(this.value);
            const day = date.getUTCDay();
            if (day === 0 || day === 6) { // 0 = Sunday, 6 = Saturday
                alert('Please select a date between Monday and Friday.');
                this.value = '';
            }
            else if (date < new Date()) {
                alert('Please select a future date.');
                this.value = '';
            }
        });
    });
});

document.addEventListener('DOMContentLoaded', function () {
        const dateInput = document.getElementById('departure_date');

        // Set the minimum date to today
        const today = new Date();
        const todayISO = today.toISOString().split('T')[0];
        dateInput.setAttribute('min', todayISO);

        // Set the maximum date to three months from today
        const threeMonthsFromToday = new Date();
        threeMonthsFromToday.setMonth(threeMonthsFromToday.getMonth() + 3);
        const maxDateISO = threeMonthsFromToday.toISOString().split('T')[0];
        dateInput.setAttribute('max', maxDateISO);

        // Add validation to ensure the selected date is within the range
        dateInput.addEventListener('input', function () {
            const selectedDate = new Date(this.value);
            if (selectedDate < today) {
                alert('Please select a future date.');
                this.value = '';
            } else if (selectedDate > threeMonthsFromToday) {
                alert('Bookings are only allowed up to three months in advance.');
                this.value = '';
            }
        });
    });
    </script>

</head>

<header>
    <div class="row">
        <div class="navigbar">
            <div class="bristol-logo">
                <img src="{{ url_for('static', filename='images/horizon-logo-finalV2.png') }}" alt="bristol" width="110" height="30">
            </div>   
            <div class="naviga">
                <h10> </h10>
            </div>
               <nav>
                <ul>
                <li><a href="{{ url_for('logout') }}"> <h10>Logout</h10>  </a></li>
                
                </ul>
               </nav>
           </div> 
        </div>     
</header>

<body>
    <div class="tiny-contaner1">
        <div class="row">
           <div class="collumn-6">
            <a href="{{ url_for('CustomerInfo') }}">
            <h6>My details</h6>
            </a>
           </div>
       <div class="collumn-6">
        <a href="{{ url_for('booking') }}">
        <h6>Add Booking</h6>
        </a>
       </div> 
       <div class="collumn-6">
        <a href="{{ url_for('update_password') }}">
        <h6>Update Password</h6>
        </a>
       </div>
           {% if is_admin %}
           <div class="collumn-6">
            <a href="{{ url_for('admin_flights') }}">
            <h6>Admin Panel</h6>
            </a>
           </div>
           {% endif %}
          </div>
        </div>
    <div class="booking-form">
        <h2>Book Your Trip</h2>

        <form action="{{ url_for('book_trip') }}" method="POST">
            <div class="form-group">
                <label for="route">Routes</label>
                <select id="route" name="route" required>
                    {% for flight in flights %}
                        <option value="{{ flight.FlightID }}">{{ flight.Destination }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="departure_date">Departure Date</label>
                <input type="date" id="departure_date" name="departure_date" required>
            </div>

            <div class="form-group">
                <label for="num_seats">Number of Seat</label>
                <input type="number" id="num_seats" name="num_seats" min="1" max="100" required>
            </div>

            <div class="form-group">
                <label for="class_type">Class</label>
                <select id="class_type" name="class_type" required>
                    <option value="Business">Business</option>
                    <option value="Economy">Economy</option>
                </select>
            </div>
            
            <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div>
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
            <div class="form-group">
                <button type="submit">Book Now</button>
            </div>
        </form>
    </div>
</body>
</html>

